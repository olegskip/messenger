syntax = "proto3";
option go_package="./pb";

service AuthMs {
	// Generates a new Rt and a Jwt
	rpc GetNewRt(Credentials) returns (Tokens) {}
	
	// After thic call the old Jwt should revoked and a new jwt are generated
	// The call can be used e.g. when the old Jwt will be expired soon
	rpc ExchangeRt(Rt) returns (Rt) {}

	// Geneterates a Jwt based on the Rt, if Rt is invalid empty jwt is returned
	rpc GetNewJwt(Rt) returns (Jwt) {}

	rpc Revoke(Tokens) returns (RevokeResponse) {}

	// Get a user based on the jwt
	rpc GetUser(Jwt) returns (User) {}
}

message Credentials {
	string username = 1;
	string password = 2;
}

message Rt {
	string token = 1;
}

message Jwt {
	string token = 1;
}

message Tokens {
	Rt rt = 1;
	Jwt jwt = 2;
}

message RevokeResponse {
	string error = 1;
}

message User {
	string id = 1;
}

